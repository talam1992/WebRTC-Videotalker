{"ast":null,"code":"import socketClient from 'socket.io-client';\nimport store from '../../store/store';\nimport * as dashboardActions from '../../store/actions/dashboardActions';\nimport * as webRTCHandler from '../webRTC/webRTCHandler';\nconst SERVER = 'http://localhost:5000';\nconst broadcastEventTypes = {\n  ACTIVE_USERS: 'ACTIVE_USERS',\n  GROUP_CALL_ROOMS: 'GROUP_CALL_ROOMS'\n};\nlet socket;\nexport const connectWithWebSocket = () => {\n  socket = socketClient(SERVER);\n  socket.on('connection', () => {\n    console.log('succesfully connected with wss server');\n    console.log(socket.id);\n  });\n  socket.on('broadcast', data => {\n    handleBroadcastEvents(data);\n  }); // listeners related with direct call\n\n  socket.on('pre-offer', data => {\n    webRTCHandler.handlePreOffer(data);\n  });\n  socket.on('pre-offer-answer', data => {\n    webRTCHandler.handlePreOfferAnswer(data);\n  });\n};\nexport const registerNewUser = username => {\n  socket.emit('register-new-user', {\n    username: username,\n    socketId: socket.id\n  });\n}; // emitting events to server related with direct call\n\nexport const sendPreOffer = data => {\n  socket.emit('pre-offer', data);\n};\nexport const sendPreOfferAnswer = data => {\n  socket.emit('pre-offer-answer', data);\n};\n\nconst handleBroadcastEvents = data => {\n  switch (data.event) {\n    case broadcastEventTypes.ACTIVE_USERS:\n      const activeUsers = data.activeUsers.filter(activeUser => activeUser.socketId !== socket.id);\n      store.dispatch(dashboardActions.setActiveUsers(activeUsers));\n      break;\n\n    default:\n      break;\n  }\n};","map":{"version":3,"sources":["C:/Users/Timothy Lam/Documents/GitHub/WebRTC-Videotalker/video-talker-frontend/src/utils/wssConnection/wssConnection.js"],"names":["socketClient","store","dashboardActions","webRTCHandler","SERVER","broadcastEventTypes","ACTIVE_USERS","GROUP_CALL_ROOMS","socket","connectWithWebSocket","on","console","log","id","data","handleBroadcastEvents","handlePreOffer","handlePreOfferAnswer","registerNewUser","username","emit","socketId","sendPreOffer","sendPreOfferAnswer","event","activeUsers","filter","activeUser","dispatch","setActiveUsers"],"mappings":"AAAA,OAAOA,YAAP,MAAyB,kBAAzB;AACA,OAAOC,KAAP,MAAkB,mBAAlB;AACA,OAAO,KAAKC,gBAAZ,MAAkC,sCAAlC;AACA,OAAO,KAAKC,aAAZ,MAA+B,yBAA/B;AAEA,MAAMC,MAAM,GAAG,uBAAf;AAEA,MAAMC,mBAAmB,GAAG;AAC1BC,EAAAA,YAAY,EAAE,cADY;AAE1BC,EAAAA,gBAAgB,EAAE;AAFQ,CAA5B;AAKA,IAAIC,MAAJ;AAEA,OAAO,MAAMC,oBAAoB,GAAG,MAAM;AACxCD,EAAAA,MAAM,GAAGR,YAAY,CAACI,MAAD,CAArB;AAEAI,EAAAA,MAAM,CAACE,EAAP,CAAU,YAAV,EAAwB,MAAM;AAC5BC,IAAAA,OAAO,CAACC,GAAR,CAAY,uCAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAYJ,MAAM,CAACK,EAAnB;AACD,GAHD;AAKAL,EAAAA,MAAM,CAACE,EAAP,CAAU,WAAV,EAAwBI,IAAD,IAAU;AAC/BC,IAAAA,qBAAqB,CAACD,IAAD,CAArB;AACD,GAFD,EARwC,CAYxC;;AACAN,EAAAA,MAAM,CAACE,EAAP,CAAU,WAAV,EAAwBI,IAAD,IAAU;AAC/BX,IAAAA,aAAa,CAACa,cAAd,CAA6BF,IAA7B;AACD,GAFD;AAIAN,EAAAA,MAAM,CAACE,EAAP,CAAU,kBAAV,EAA+BI,IAAD,IAAU;AACtCX,IAAAA,aAAa,CAACc,oBAAd,CAAmCH,IAAnC;AACD,GAFD;AAGD,CApBM;AAuBP,OAAO,MAAMI,eAAe,GAAIC,QAAD,IAAc;AAC3CX,EAAAA,MAAM,CAACY,IAAP,CAAY,mBAAZ,EAAiC;AAC/BD,IAAAA,QAAQ,EAAEA,QADqB;AAE/BE,IAAAA,QAAQ,EAAEb,MAAM,CAACK;AAFc,GAAjC;AAID,CALM,C,CAOP;;AAEA,OAAO,MAAMS,YAAY,GAAIR,IAAD,IAAU;AACpCN,EAAAA,MAAM,CAACY,IAAP,CAAY,WAAZ,EAAyBN,IAAzB;AACD,CAFM;AAIP,OAAO,MAAMS,kBAAkB,GAAIT,IAAD,IAAU;AAC1CN,EAAAA,MAAM,CAACY,IAAP,CAAY,kBAAZ,EAAgCN,IAAhC;AACD,CAFM;;AAIP,MAAMC,qBAAqB,GAAID,IAAD,IAAU;AACtC,UAAQA,IAAI,CAACU,KAAb;AACE,SAAKnB,mBAAmB,CAACC,YAAzB;AACE,YAAMmB,WAAW,GAAGX,IAAI,CAACW,WAAL,CAAiBC,MAAjB,CAAwBC,UAAU,IAAIA,UAAU,CAACN,QAAX,KAAwBb,MAAM,CAACK,EAArE,CAApB;AACAZ,MAAAA,KAAK,CAAC2B,QAAN,CAAe1B,gBAAgB,CAAC2B,cAAjB,CAAgCJ,WAAhC,CAAf;AACA;;AACF;AACE;AANJ;AAQD,CATD","sourcesContent":["import socketClient from 'socket.io-client';\nimport store from '../../store/store';\nimport * as dashboardActions from '../../store/actions/dashboardActions';\nimport * as webRTCHandler from '../webRTC/webRTCHandler';\n\nconst SERVER = 'http://localhost:5000';\n\nconst broadcastEventTypes = {\n  ACTIVE_USERS: 'ACTIVE_USERS',\n  GROUP_CALL_ROOMS: 'GROUP_CALL_ROOMS'\n};\n\nlet socket;\n\nexport const connectWithWebSocket = () => {\n  socket = socketClient(SERVER);\n\n  socket.on('connection', () => {\n    console.log('succesfully connected with wss server');\n    console.log(socket.id);\n  });\n\n  socket.on('broadcast', (data) => {\n    handleBroadcastEvents(data);\n  });\n\n  // listeners related with direct call\n  socket.on('pre-offer', (data) => {\n    webRTCHandler.handlePreOffer(data);\n  });\n\n  socket.on('pre-offer-answer', (data) => {\n    webRTCHandler.handlePreOfferAnswer(data);\n  })\n}\n;\n\nexport const registerNewUser = (username) => {\n  socket.emit('register-new-user', {\n    username: username,\n    socketId: socket.id\n  });\n};\n\n// emitting events to server related with direct call\n\nexport const sendPreOffer = (data) => {\n  socket.emit('pre-offer', data);\n};\n\nexport const sendPreOfferAnswer = (data) => {\n  socket.emit('pre-offer-answer', data);\n}\n\nconst handleBroadcastEvents = (data) => {\n  switch (data.event) {\n    case broadcastEventTypes.ACTIVE_USERS:\n      const activeUsers = data.activeUsers.filter(activeUser => activeUser.socketId !== socket.id);\n      store.dispatch(dashboardActions.setActiveUsers(activeUsers));\n      break;\n    default:\n      break;\n  }\n}\n;\n"]},"metadata":{},"sourceType":"module"}